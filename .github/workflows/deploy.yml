name: deploy

on:
  issue_comment:
    types:
      - created

jobs:
  deploy:
    runs-on: ubuntu-latest
    env:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

    steps:
      - uses: actions/checkout@v3
      
      - name: Deploy
        if: ${{ !github.event.issue.pull_request }} && contains(github.event.comment.body, "/deploy")
        run: |
          TARGET=$(echo ${{ github.event.comment.body }} | cut -d ' ' -f2)
          echo "Deploying $TARGET !"
        
      - name: Close issue
        if: ${{ !github.event.issue.pull_request }} && contains(github.event.comment.body, "/deploy")
        run: |
          gh issue close ${{ github.event.issue.number }} --comment "Successfully deployed!"
